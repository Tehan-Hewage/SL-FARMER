<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#166534">
  <meta name="color-scheme" content="light dark">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Pineapple Farm">
  <meta name="pf-fcm-vapid-key" content="BDOCKbz0ZbCgKXIscjbtGv0DBd5Ag-_dIAci26z5Y-hWW1Rc4UpuJeTXZath2uccxmUb2JdaLg663MswF08s2kY">
  <title>Pineapple Farm Management System</title>
  <link rel="manifest" href="manifest.webmanifest?v=20260220-4">
  <link rel="apple-touch-icon" href="Img/icon-192.png">
  <link rel="icon" type="image/png" sizes="192x192" href="Img/icon-192.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Space+Grotesk:wght@600;700&display=swap" rel="stylesheet">
  <script>
    (function () {
      try {
        var savedTheme = localStorage.getItem("pf-theme");
        if (savedTheme === "dark" || savedTheme === "light") {
          document.documentElement.setAttribute("data-theme", savedTheme);
        }
      } catch (error) {}
    })();
  </script>
  <link rel="stylesheet" href="css/style.css?v=20260302-4">
  <link rel="stylesheet" href="css/firebase-app.css?v=20260302-6">
</head>
<body>
<div id="appLoadingOverlay" class="app-loading-overlay" aria-hidden="false">
  <div class="app-loading-shell" role="status" aria-live="polite">
    <div class="app-loading-brand">
      <img src="Img/logo.png" alt="Pineapple Farm Logo" class="app-loading-logo">
      <div class="app-loading-brand-copy">
        <h2>Pineapple Farm Admin</h2>
        <p>Securing your workspace and syncing live data</p>
      </div>
    </div>
    <div class="app-loading-status">
      <span class="app-loading-pulse"></span>
      <span id="appLoadingMessage">Preparing admin panel...</span>
    </div>
    <div class="app-loading-track"><span></span></div>
  </div>
</div>
<div id="authOverlay" class="auth-overlay hidden">
  <div class="auth-card">
    <a href="../index.html" class="auth-back-btn" aria-label="Back to website">
      <i class="fas fa-arrow-left"></i>
      <span>Back</span>
    </a>
    <div class="auth-brand">
      <img src="Img/logo.png" alt="Pineapple Farm Logo" class="auth-logo">
      <h2>Pineapple Farm MS Login</h2>
      <p>Sign in as <strong>Admin</strong> or <strong>User</strong></p>
    </div>
    <div class="auth-mode-switch" role="tablist" aria-label="Authentication mode">
      <button type="button" class="auth-mode-btn active" data-auth-mode-btn="login">Login</button>
      <button type="button" class="auth-mode-btn" data-auth-mode-btn="signup">Create Account</button>
    </div>
    <form id="loginForm" class="auth-form is-active">
      <label for="loginEmail">Email</label>
      <input id="loginEmail" type="email" class="form-control" placeholder="name@email.com" required>
      <label for="loginPassword">Password</label>
      <input id="loginPassword" type="password" class="form-control" placeholder="Enter password" required>
      <button type="submit" class="btn auth-submit"><i class="fas fa-sign-in-alt"></i> Login</button>
      <p id="loginError" class="auth-error" aria-live="polite"></p>
      <p class="auth-alt-action">No account? <button type="button" class="auth-link-btn" data-auth-mode="signup">Create account</button></p>
    </form>
    <form id="signupForm" class="auth-form" hidden>
      <label for="signupName">User Name</label>
      <input id="signupName" type="text" class="form-control" placeholder="Enter your name" required>
      <label for="signupEmail">Email</label>
      <input id="signupEmail" type="email" class="form-control" placeholder="name@email.com" required>
      <label for="signupPassword">Password</label>
      <input id="signupPassword" type="password" class="form-control" placeholder="At least 6 characters" minlength="6" required>
      <button type="submit" class="btn auth-submit"><i class="fas fa-user-plus"></i> Create Account</button>
      <p id="signupError" class="auth-error" aria-live="polite"></p>
      <p class="auth-alt-action">Have an account? <button type="button" class="auth-link-btn" data-auth-mode="login">Back to login</button></p>
    </form>
  </div>
</div>

<div class="container">
  <header>
    <nav class="navbar">
      <div class="logo">
        <img src="Img/logo.png" alt="Pineapple Farm Logo" class="logo-image">
        <span>Pineapple Farm MS</span>
      </div>
      <button id="mobile-menu-btn" class="mobile-menu-btn" type="button" aria-label="Toggle navigation" aria-expanded="false">
        <i class="fas fa-bars"></i>
      </button>
      <div class="nav-links">
        <a href="#" class="active" data-section="dashboard"><i class="fas fa-home"></i> Dashboard</a>
        <a href="#" data-section="lands"><i class="fas fa-tractor"></i> Lands</a>
        <a href="#" data-section="harvest"><i class="fas fa-apple-alt"></i> Harvest</a>
        <a href="#" data-section="expenses"><i class="fas fa-money-bill-wave"></i> Expenses</a>
        <a href="#" data-section="labor"><i class="fas fa-users"></i> Labor</a>
        <a href="#" data-section="tasks"><i class="fas fa-calendar-check"></i> Tasks</a>
        <a href="#" data-section="users" class="admin-only"><i class="fas fa-user-shield"></i> Users</a>
      </div>
        <div class="nav-actions">
          <div class="nav-tools">
          <button type="button" class="btn btn-sm btn-install" id="installAppBtn" aria-label="Install app">
            <i class="fas fa-download"></i>
            <span class="btn-label">Install App</span>
          </button>
          <button type="button" class="btn btn-sm btn-theme-toggle" id="themeToggleBtn" aria-label="Toggle dark and light mode">
            <i class="fas fa-moon"></i>
            <span class="btn-label">Dark</span>
          </button>
          </div>
          <div class="nav-auth" id="navAuth" hidden>
            <button type="button" class="profile-btn" id="openProfileBtn" aria-label="Open profile">
              <span class="profile-avatar" id="navProfileAvatar"><span id="navProfileInitials">U</span></span>
              <span class="profile-btn-text">Profile</span>
            </button>
          <button type="button" class="btn btn-sm" id="logoutBtn" aria-label="Logout">
            <i class="fas fa-right-from-bracket"></i>
            <span class="btn-label">Logout</span>
          </button>
          </div>
        </div>
      </nav>
  </header>

  <main class="main-content">
    <div id="appAlert"></div>
    <div id="accessNotice"></div>

    <section id="section-dashboard" class="app-section active">
      <div class="dashboard">
        <h1><i class="fas fa-seedling"></i> Farm Dashboard</h1>
        <p class="subtitle">Live metrics from Firestore</p>
        <div class="dashboard-stats">
          <div class="stat-card"><div class="stat-icon" style="background-color:#4CAF50;"><i class="fas fa-tractor"></i></div><div class="stat-info"><h3>Active Lands</h3><p class="stat-number" id="statActiveLands">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background-color:#2196F3;"><i class="fas fa-seedling"></i></div><div class="stat-info"><h3>Total Plants</h3><p class="stat-number" id="statTotalPlants">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background-color:#FF9800;"><i class="fas fa-money-bill-wave"></i></div><div class="stat-info"><h3>Total Revenue</h3><p class="stat-number" id="statRevenue">Rs. 0.00</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background-color:#E53935;"><i class="fas fa-file-invoice-dollar"></i></div><div class="stat-info"><h3>Total Expenses</h3><p class="stat-number" id="statExpenses">Rs. 0.00</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background-color:#7B1FA2;"><i class="fas fa-chart-line"></i></div><div class="stat-info"><h3>Net Profit</h3><p class="stat-number" id="statProfit">Rs. 0.00</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background-color:#00897B;"><i class="fas fa-calendar-day"></i></div><div class="stat-info"><h3>Upcoming Tasks (7d)</h3><p class="stat-number" id="statTasks">0</p></div></div>
        </div>
        <div class="table-section">
          <h2><i class="fas fa-list-check"></i> Pending Tasks</h2>
          <table class="data-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Time</th>
                <th>Countdown</th>
                <th>Land</th>
                <th>Type</th>
                <th>Category</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="dashboardPendingTaskRows"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="section-lands" class="app-section">
      <div class="dashboard lands-page">
        <div class="dashboard-header">
          <div>
            <h1><i class="fas fa-tractor"></i> Land Management</h1>
            <p class="subtitle section-subtitle">Manage your pineapple farming lands</p>
          </div>
          <button class="btn admin-only" type="button" id="toggleLandFormBtn"><i class="fas fa-plus"></i> Add New Land</button>
        </div>

        <div class="form-container collapsible-panel admin-only" id="landFormPanel">
          <h2 class="form-title"><i class="fas fa-plus-circle"></i> Add New Land</h2>
          <form id="landForm" class="simple-form"></form>
        </div>

        <div class="dashboard-stats compact-stats">
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#4CAF50,#2E7D32);"><i class="fas fa-map-marked-alt"></i></div><div class="stat-info"><h3>Total Lands</h3><p class="stat-number" id="landStatTotal">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#2196F3,#1976D2);"><i class="fas fa-map"></i></div><div class="stat-info"><h3>Active Lands</h3><p class="stat-number" id="landStatActive">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#FF9800,#F57C00);"><i class="fas fa-seedling"></i></div><div class="stat-info"><h3>Total Plants</h3><p class="stat-number" id="landStatPlants">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#43e97b,#38f9d7);"><i class="fas fa-chart-line"></i></div><div class="stat-info"><h3>Total Revenue</h3><p class="stat-number" id="landStatRevenue">Rs. 0.00</p></div></div>
        </div>

        <div class="section-row section-title-row">
          <div>
            <h2><i class="fas fa-map-marked-alt"></i> Select Land</h2>
            <p>Click on a land to view details and manage activities</p>
          </div>
        </div>

        <div id="landsGrid" class="lands-grid"></div>
      </div>
    </section>

    <section id="section-harvest" class="app-section">
      <div class="dashboard harvest-page">
        <div class="dashboard-header">
          <div>
            <h1><i class="fas fa-apple-alt"></i> Harvest Management</h1>
            <p class="subtitle section-subtitle">Track and manage all pineapple harvests efficiently</p>
          </div>
          <button class="btn btn-outline admin-only" type="button" id="toggleHarvestFormBtn"><i class="fas fa-plus"></i> Add Harvest Record</button>
        </div>

        <div class="form-container collapsible-panel admin-only" id="harvestFormPanel">
          <h2 class="form-title"><i class="fas fa-plus-circle"></i> Add Harvest</h2>
          <form id="harvestForm" class="simple-form"></form>
        </div>

        <div class="dashboard-stats compact-stats">
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);"><i class="fas fa-seedling"></i></div><div class="stat-info"><h3>Total Plants</h3><p class="stat-number" id="harvestStatPlants">0</p><small>Active cultivation</small></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);"><i class="fas fa-calendar-alt"></i></div><div class="stat-info"><h3>Total Harvest Events</h3><p class="stat-number" id="harvestStatEvents">0</p><small>All time records</small></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%);"><i class="fas fa-clock"></i></div><div class="stat-info"><h3>Last Harvest</h3><p class="stat-number stat-number-sm" id="harvestStatLast">N/A</p><small>Most recent activity</small></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%);"><i class="fas fa-chart-line"></i></div><div class="stat-info"><h3>Total Revenue</h3><p class="stat-number" id="harvestStatRevenue">Rs. 0.00</p><small>Cumulative earnings</small></div></div>
        </div>

        <div class="table-section">
          <div class="section-row">
            <h2><i class="fas fa-history"></i> Recent Harvests</h2>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Land</th>
                <th>Total KG</th>
                <th>Grades (A/B/C)</th>
                <th>Revenue</th>
                <th>Avg Price/KG</th>
                <th>Buyer</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="harvestRows"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="section-expenses" class="app-section">
      <div class="dashboard expenses-page">
        <div class="dashboard-header">
          <h1><i class="fas fa-money-bill-wave"></i> Expenses Management</h1>
          <button class="btn admin-only" type="button" id="toggleExpenseFormBtn"><i class="fas fa-plus-circle"></i> Add New Expense</button>
        </div>

        <div class="form-container collapsible-panel admin-only" id="expenseFormPanel">
          <h2 class="form-title"><i class="fas fa-plus-circle"></i> Add Expense</h2>
          <form id="expenseForm" class="simple-form"></form>
        </div>

        <div class="filter-section">
          <div class="filter-row">
            <div class="filter-group">
              <label><i class="fas fa-tractor"></i> Land</label>
              <select id="expenseFilterLand" class="form-control"></select>
            </div>
            <div class="filter-group">
              <label><i class="fas fa-tags"></i> Type</label>
              <select id="expenseFilterType" class="form-control">
                <option value="">All Types</option>
                <option value="plants">Plants</option>
                <option value="labor">Labor</option>
                <option value="fertilizer">Fertilizer</option>
                <option value="chemicals">Chemicals</option>
                <option value="tools_equipment">Tools &amp; Equipment</option>
                <option value="machines">Machines</option>
                <option value="transport">Transport</option>
                <option value="irrigation">Irrigation</option>
                <option value="land_preparation">Land Preparation</option>
                <option value="extra">Extra</option>
              </select>
            </div>
            <div class="filter-group">
              <label><i class="fas fa-calendar"></i> Date From</label>
              <input id="expenseFilterFrom" class="form-control" type="date">
            </div>
            <div class="filter-group">
              <label><i class="fas fa-calendar"></i> Date To</label>
              <input id="expenseFilterTo" class="form-control" type="date">
            </div>
            <div class="filter-group filter-button-wrap">
              <button type="button" class="btn btn-secondary" id="expenseFilterReset"><i class="fas fa-redo"></i> Reset</button>
            </div>
          </div>
        </div>

        <div class="dashboard-stats compact-stats">
          <div class="stat-card"><div class="stat-icon" style="background-color:#dc3545;"><i class="fas fa-money-bill-wave"></i></div><div class="stat-info"><h3>Total Expenses</h3><p class="stat-number" id="expenseStatTotal">Rs. 0.00</p><small id="expenseStatScope">All Lands</small></div></div>
          <div class="stat-card"><div class="stat-icon" style="background-color:#ff9800;"><i class="fas fa-calendar-alt"></i></div><div class="stat-info"><h3>This Month</h3><p class="stat-number" id="expenseStatMonth">Rs. 0.00</p><small>Current month</small></div></div>
          <div class="stat-card"><div class="stat-icon" style="background-color:#2196F3;"><i class="fas fa-chart-pie"></i></div><div class="stat-info"><h3>Top Category</h3><p class="stat-number" id="expenseStatTopCategory">N/A</p><small>Highest spend</small></div></div>
          <div class="stat-card"><div class="stat-icon" style="background-color:#9C27B0;"><i class="fas fa-receipt"></i></div><div class="stat-info"><h3>Total Records</h3><p class="stat-number" id="expenseStatRecords">0</p><small>Filtered results</small></div></div>
        </div>

        <div class="export-buttons">
          <button type="button" class="export-btn excel" id="expenseExportCsv"><i class="fas fa-file-excel"></i> Export Excel</button>
          <button type="button" class="export-btn pdf" id="expenseExportPdf"><i class="fas fa-file-pdf"></i> Export PDF</button>
          <button type="button" class="export-btn print" id="expensePrintBtn"><i class="fas fa-print"></i> Print Report</button>
        </div>

        <div class="table-section">
          <h2><i class="fas fa-list"></i> Expenses List</h2>
          <table class="data-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Land</th>
                <th>Type</th>
                <th>Category</th>
                <th>Plant Count</th>
                <th>Amount</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="expenseRows"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="section-labor" class="app-section">
      <div class="dashboard labor-page">
        <div class="dashboard-header">
          <h1><i class="fas fa-users"></i> Manage Laborers</h1>
          <button class="btn admin-only" type="button" id="toggleLaborFormBtn"><i class="fas fa-user-plus"></i> Add New Laborer</button>
        </div>

        <div class="form-container collapsible-panel admin-only" id="laborFormPanel">
          <h2 class="form-title"><i class="fas fa-user-plus"></i> Add Laborer</h2>
          <form id="laborForm" class="simple-form"></form>
        </div>

        <div class="dashboard-stats compact-stats">
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#4CAF50,#2E7D32);"><i class="fas fa-users"></i></div><div class="stat-info"><h3>Total Laborers</h3><p class="stat-number" id="laborStatTotal">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#2196F3,#1976D2);"><i class="fas fa-user-check"></i></div><div class="stat-info"><h3>Active</h3><p class="stat-number" id="laborStatActive">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#FF9800,#F57C00);"><i class="fas fa-user-clock"></i></div><div class="stat-info"><h3>On Leave</h3><p class="stat-number" id="laborStatLeave">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#9C27B0,#7B1FA2);"><i class="fas fa-user-slash"></i></div><div class="stat-info"><h3>Inactive</h3><p class="stat-number" id="laborStatInactive">0</p></div></div>
        </div>

        <div class="filter-section">
          <div class="form-group search-group">
            <div class="input-group">
              <input id="laborSearch" class="form-control" placeholder="Search by name, contact, skills, or land...">
              <button id="laborSearchBtn" class="btn" type="button"><i class="fas fa-search"></i> Search</button>
            </div>
          </div>
          <div class="filter-row">
            <div class="filter-group">
              <label><i class="fas fa-tractor"></i> Filter by Land</label>
              <select id="laborFilterLand" class="form-control"></select>
            </div>
            <div class="filter-group">
              <label><i class="fas fa-user-check"></i> Filter by Status</label>
              <select id="laborFilterStatus" class="form-control">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
                <option value="on_leave">On Leave</option>
              </select>
            </div>
            <div class="filter-group">
              <label><i class="fas fa-calendar"></i> Join Date From</label>
              <input id="laborFilterFrom" class="form-control" type="date">
            </div>
            <div class="filter-group">
              <label><i class="fas fa-calendar"></i> Join Date To</label>
              <input id="laborFilterTo" class="form-control" type="date">
            </div>
            <div class="filter-group">
              <label><i class="fas fa-sort"></i> Sort By</label>
              <select id="laborSortBy" class="form-control">
                <option value="laborer_name">Name</option>
                <option value="join_date">Join Date</option>
                <option value="status">Status</option>
                <option value="land_name">Land</option>
              </select>
            </div>
            <div class="filter-group">
              <label><i class="fas fa-sort-amount-down"></i> Order</label>
              <select id="laborSortOrder" class="form-control">
                <option value="asc">Ascending</option>
                <option value="desc">Descending</option>
              </select>
            </div>
          </div>
        </div>

        <div class="table-section">
          <h2><i class="fas fa-users"></i> Laborer List</h2>
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Contact</th>
                <th>Join Date</th>
                <th>Assigned Land</th>
                <th>Skills</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="laborRows"></tbody>
          </table>
          <div class="export-buttons labor-export">
            <small class="light-text">Export:</small>
            <button class="export-btn print" id="laborPrintBtn" type="button"><i class="fas fa-print"></i> Print List</button>
            <button class="export-btn excel" id="laborExportCsv" type="button"><i class="fas fa-file-excel"></i> Export to Excel</button>
          </div>
        </div>

      </div>
    </section>

    <section id="section-users" class="app-section admin-only">
      <div class="dashboard users-page">
        <div class="dashboard-header">
          <div>
            <h1><i class="fas fa-user-shield"></i> Users Management</h1>
            <p class="subtitle section-subtitle">Manage user roles, access permissions, and land assignments</p>
          </div>
        </div>

        <div class="dashboard-stats compact-stats">
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#4CAF50,#2E7D32);"><i class="fas fa-users"></i></div><div class="stat-info"><h3>Total Users</h3><p class="stat-number" id="userStatTotal">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#1565C0,#1E88E5);"><i class="fas fa-user-shield"></i></div><div class="stat-info"><h3>Admins</h3><p class="stat-number" id="userStatAdmins">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#00897B,#26A69A);"><i class="fas fa-map-marked-alt"></i></div><div class="stat-info"><h3>Assigned Lands</h3><p class="stat-number" id="userStatAssigned">0</p></div></div>
          <div class="stat-card"><div class="stat-icon" style="background:linear-gradient(135deg,#F57C00,#FFB300);"><i class="fas fa-user-clock"></i></div><div class="stat-info"><h3>Unassigned</h3><p class="stat-number" id="userStatUnassigned">0</p></div></div>
        </div>

        <div class="table-section">
          <h2><i class="fas fa-user-cog"></i> Users &amp; Land Assignment</h2>
          <table class="data-table">
            <thead>
              <tr>
                <th>User</th>
                <th>Email</th>
                <th>Role</th>
                <th>Access</th>
                <th>Assigned Lands</th>
                <th>Last Updated</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="userRows"></tbody>
          </table>
        </div>
      </div>
    </section>

        <section id="section-tasks" class="app-section">
      <div class="dashboard tasks-page">
        <div class="dashboard-header">
          <h1><i class="fas fa-calendar-check"></i> Expense Tasks</h1>
          <div class="task-header-actions">
            <button type="button" class="btn admin-only" id="toggleTaskFormBtn"><i class="fas fa-plus"></i> Add Task</button>
            <button type="button" class="btn btn-secondary task-notify-toggle admin-only" id="toggleTaskNotificationsBtn">
              <i class="fas fa-bell"></i> Turn On 3-to-Today Alerts
            </button>
          </div>
        </div>

        <div class="form-container collapsible-panel admin-only" id="taskFormPanel"><h2 class="form-title"><i class="fas fa-plus-circle"></i> Add Task</h2><form id="taskForm" class="simple-form"></form></div>

        <div class="table-section"><h2><i class="fas fa-list-check"></i> Task List</h2><table class="data-table"><thead><tr><th>Date</th><th>Time</th><th>Countdown</th><th>Land</th><th>Type</th><th>Category</th><th>Status</th><th>Actions</th></tr></thead><tbody id="taskRows"></tbody></table></div>
      </div>
    </section>
    <section id="section-profile" class="app-section">
      <div class="dashboard profile-page">
        <div class="dashboard-header">
          <div>
            <h1><i class="fas fa-user-circle"></i> My Profile</h1>
            <p class="subtitle section-subtitle">Manage your account details</p>
          </div>
          <button type="button" class="btn btn-secondary" id="profileLogoutBtn"><i class="fas fa-right-from-bracket"></i> Logout</button>
        </div>

        <div class="profile-layout">
          <div class="profile-summary">
            <div class="profile-avatar-large" id="profileAvatarLarge"><span id="profileInitials">U</span></div>
            <h3 id="profileNameHeading">User</h3>
            <span id="profileRoleBadge" class="role-badge role-user">User</span>
            <p id="profileEmailText" class="profile-email">-</p>
            <p id="profileUpdatedAt" class="light-text">No profile updates yet.</p>
          </div>

          <div class="form-container profile-editor">
            <h2 class="form-title"><i class="fas fa-pen-to-square"></i> Edit Profile</h2>
            <form id="profileForm" class="simple-form">
              <div class="simple-form-grid">
                <div class="form-group">
                  <label for="profileEmail">Email</label>
                  <input id="profileEmail" class="form-control" type="email" readonly>
                </div>
                <div class="form-group">
                  <label for="profileRole">Role</label>
                  <input id="profileRole" class="form-control" type="text" readonly>
                </div>
                <div class="form-group">
                  <label for="profileDisplayName">Display Name</label>
                  <input id="profileDisplayName" class="form-control" type="text" placeholder="Your name">
                </div>
                <div class="form-group">
                  <label for="profilePhone">Phone</label>
                  <input id="profilePhone" class="form-control" type="tel" placeholder="+94 7X XXX XXXX">
                </div>
                <div class="form-group">
                  <label for="profileLocation">Location</label>
                  <input id="profileLocation" class="form-control" type="text" placeholder="City / Area">
                </div>
                <div class="form-group full">
                  <label for="profileBio">Bio</label>
                  <textarea id="profileBio" class="form-control" placeholder="Short bio"></textarea>
                </div>
              </div>
              <div class="form-actions-row">
                <button type="submit" class="btn" id="profileSaveBtn"><i class="fas fa-save"></i> Save Profile</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer><div class="footer-content"><p>&copy; <span id="year"></span> Pineapple Farm Management System</p></div></footer>
</div>
<script src="js/theme.js?v=20260220-4" defer></script>
<script type="module" src="js/firebase-app.js?v=20260302-6"></script>
<script src="js/pwa.js?v=20260220-4" defer></script>
</body>
</html>
